@inject HttpClient httpClient


<div class="OnlineUsersComponentContainer">
    <div class="GroupHeader">
        <h3>Explore the learning groups</h3>
    </div>
    <div class="MainSection">
        <div class="DisplayGroupSection">
            @if (groups?.Count > 0)
            {
                foreach (var group in groups)
                {
                    <div class="group">
                        <div style="width: 100%; display: grid; place-content: center;">
                            <h3>@group.Name</h3>
                        </div>
                        <div style="width: 100%; display: grid; place-content: center;">
                            <img src="@group.PictureURI" />
                        </div>
                        <h5 style="margin-top: 4px;">@group.Purpose</h5>
                        <h5 style="margin-top: 4px;">Currently online users: @group.OnlineUsers</h5>
                        <div style="width: 100%; display: grid; place-content: center;">
                            <button @onclick="() => ChosenGroup.InvokeAsync(group)">Select Group</button>
                        </div>
                    </div>
                }
            }
        </div>
        <div class="ManageGroupSection">
            <div>
                
            </div>
        </div>
    </div>
</div>


@code{
    [Parameter]
    public EventCallback<GroupDTO> ChosenGroup { get; set; }
    [CascadingParameter]
    public HubConnection hubConnection { get; set; }

    private List<GroupDTO> groups;
    protected override async Task OnInitializedAsync()
    {
        groups = await httpClient.GetFromJsonAsync<List<GroupDTO>>("/api/group/GetAllGroups");
        StateHasChanged();

        hubConnection.On("UpdateGroups", async () =>
        {
            groups = await httpClient.GetFromJsonAsync<List<GroupDTO>>("/api/group/GetAllGroups");
            StateHasChanged();
        });
    }
}